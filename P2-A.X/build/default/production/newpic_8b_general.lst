MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 ;P2_FA
                      00002     
Warning[215]: Processor superseded by command line.  Verify processor symbol.
                      00003     LIST P=PIC18F4321   F=INHX32
                      00004     #include <p18f4321.inc>
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ; Build date : Mar 17 2019
                      00005 ;  MPASM PIC18F4321 processor include
                      00006 ; 
                      00007 ;  (c) Copyright 1999-2019 Microchip Technology, All rights reserved
                      00008 ;==========================================================================
                      00009 
                      01455         LIST
                      00005     
                      00006 ; CONFIGS ----------------------------------------------------------------------
                      00007 
                      00008     CONFIG  OSC=HSPLL   ; L'oscil.lador
                      00009     CONFIG  PBADEN=DIG  ; Volem que el PORTB sigui DIGital
                      00010     CONFIG  WDT=OFF     ; Desactivem el Watch Dog Timer
                      00011     CONFIG  LVP=OFF
                      00012    
                      00013 ; VARIABLES --------------------------------------------------------------------
                      00014 
  00000000            00015 COUNT_PWM           EQU 0x00        ; Pulse (10uS)
  00000001            00016 COUNT_PWM1          EQU 0x01        ; ECHO (58uS)
  00000002            00017 CASE1               EQU 0x02        ; Mode Digital
  00000003            00018 CASE2               EQU 0x03        ; Mode Analogic Single
  00000004            00019 CASE3               EQU 0x04        ; Mode Analogic Realtime
  00000005            00020 CASE4               EQU 0x05        ; Mode Singleshot
  00000006            00021 CASE5               EQU 0x06        ; Mode Auto
  00000007            00022 CASE6               EQU 0x07        ; Mode Inserir nom
  00000008            00023 CASE7               EQU 0x08        ; Mode Mostrar nom i 200 mesures
  00000009            00024 CASE8               EQU 0x09        ; Mode Mostrar última mesura
  00000010            00025 CASE9               EQU 0x10        ; Mode Auto-scan
  00000011            00026 PART_LOW            EQU 0x11        ; Interrupción T0 Low (20ms)
  00000012            00027 PART_HIGH           EQU 0x12        ; Interrupción T0 Low (20ms)
  00000013            00028 INC_PWM             EQU 0x13        ; Increment PWM
  00000014            00029 nTIMES              EQU 0x14        ; Posició Servo
  00000015            00030 PWM_FIRST_TIME      EQU 0x15        ; Posició inicial Servomotor
  00000016            00031 SERVO_POS           EQU 0x16        ; Posició Servo
  00000017            00032 REBOTS              EQU 0x17        ; Control de Rebots
  00000018            00033 MODE                EQU 0x18        ; Control de Mode
  00000019            00034 SECONDS_ECHO        EQU 0x19        ; Control Echo
  00000030            00035 POS_REALTIME        EQU 0x30        ; Calcular Posició Realtime
  00000031            00036 JT_UP               EQU 0x31        ; Joystick UP
  00000032            00037 JT_DOWN             EQU 0x32        ; Joystick DOWN
  00000033            00038 NUM7                EQU 0x33        ; Número a mostrar al 7-Segments
  00000034            00039 nLETRAS             EQU 0x34        ; Numero de lletres escrites
  00000035            00040 nLETRAS_AUX         EQU 0x35        ; Numero de lletres auxiliar
  00000036            00041 EXIT_WR             EQU 0x36        ; Flag acabar de escriure
  00000037            00042 INIT_AUTO           EQU 0x37        ; Flag Inici Mode Auto
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000038            00043 EEPROM_SIZE         EQU 0x38        ; Mida EEPROM
  00000039            00044 SALTO_LINEA         EQU 0x39        ; ASCII Salto de línea
  00000040            00045 GUION               EQU 0x40        ; ASCII GUION
  00000041            00046 ENTER               EQU 0x41        ; ASCII Enter (retorn de carro)
  00000042            00047 MESURA              EQU 0x42        ; Guardar mesura realitzada
  00000043            00048 MESURA_AUX          EQU 0x43        ; Variable Auxiliar de Mesura
  00000044            00049 UNITATS             EQU 0x44        ; Xifra Unitats Mesura
  00000045            00050 DECENAS             EQU 0x45        ; Xifra Decenes Mesura
  00000046            00051 CENTENAS            EQU 0x46        ; Xifra Centenes Mesura
  00000047            00052 POS_RAM             EQU 0x47        ; Úiltima posicio escrita de la RAM
  00000048            00053 POS_RAM_AUX         EQU 0x48        ; Varuable Auxiliar posició RAM  
  00000049            00054 HAY_MUESTRA         EQU 0x49        ; Flag si tenim alguna mostre guardada
  00000050            00055 NOM_GUARDAT         EQU 0x50        ; Flag si tenim algun nom guardar
  00000051            00056 POS_MAX             EQU 0x51        ; Guardem valor màxim mesura
  00000052            00057 nTIMES_MAX          EQU 0x52        ; Guardem posició de la màxima mesura
  00000053            00058 FER_MESURA_SINGLE   EQU 0x53        ; Flag de mode Singleshot
  00000054            00059 AUTO_ACTIVAT        EQU 0x54        ; Flag de mode Auto
  00000055            00060 AGAFA_MESURES       EQU 0x55        ; Flag de activar mesura de mostres Auto
                      00061             
  00000020            00062 TAULA7S EQU 0x20
                      00063 
                      00064     ORG 0x0000
000000 EF?? F???      00065     GOTO    MAIN
                      00066     ORG 0x0008
000008 EF?? F???      00067     GOTO    HIGH_RSI
                      00068     ORG 0x0018
000018 0011           00069     RETFIE  FAST
                      00070  
                      00071     ORG TAULA7S
                      00072     ;Segments del 0, segments del 1
000020 41CF           00073     DB 0xCF, 0x41
                      00074     ;Segments del 2, segments del 3
000022 571F           00075     DB 0x1F, 0x57
                      00076     ;Segments del 4, segments del 5
000024 D6D1           00077     DB 0xD1, 0xD6
                      00078     ;Segments del 6, segments del 7
000026 43DE           00079     DB 0xDE, 0x43
                      00080     ;Segments del 8, EXTRA
000028 FFDF           00081     DB 0xDF, 0xFF
                      00082 
                      00083    
                      00084 ; INITS ------------------------------------------------------------------------
                      00085     
00002A                00086 INIT_PORTS   ; Configura els ports I/O
                      00087     ; PORTA
00002A 8092           00088     BSF     TRISA,0,0       ; Configurem el bit AN0 d'entrada   (ADC)
00002C 9692           00089     BCF     TRISA,3,0       ; Configurem el bit RA3 de sortida  (LED Status1)
00002E 9892           00090     BCF     TRISA,4,0       ; Configurem el bit RA4 de sortida  (LED Status2)
000030 6A89           00091     CLRF    LATA,0          ; Configurem port A de sortida      (RSI)
                      00092     ; PORTB
000032 8093           00093     BSF     TRISB,0,0       ; Configurem el port RB0 d'entrada (Pos +)
000034 8293           00094     BSF     TRISB,1,0       ; Configurem el port RB1 d'entrada (Pos -)
000036 8493           00095     BSF     TRISB,2,0       ; Configurem el port RB2 d'entrada (Mesure)
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000038 9893           00096     BCF     TRISB,4,0       ; Configurem el bit RB4 de sortida
00003A 9EF1           00097     BCF     INTCON2,RBPU,0  ; Activem els pull-ups del port B.
                      00098     ; PORTC
00003C 8094           00099     BSF     TRISC,RC0,0     ; Configurem el port RC0 d'entrada (echo)
00003E 9294           00100     BCF     TRISC,RC1,0     ; Configurem el port RC1 d'entrada (trigger)
000040 8C94           00101     BSF     TRISC,RC6,0     ; Configurem el port RC6 d'entrada (TX)
000042 8E94           00102     BSF     TRISC,RC7,0     ; Configurem el port RC7 d'entrada (RX)
                      00103     ; PORTD
000044 6A95           00104     CLRF    TRISD,0         ; Configurem port D de sortida
000046 0012           00105     RETURN
                      00106     
000048                00107 INIT_INTERRUPTS             ; Activamos las interrupciones
000048 9ED0           00108     BCF RCON,IPEN,0         
00004A 8EF2           00109     BSF INTCON,GIE,0
00004C 8CF2           00110     BSF INTCON,PEIE,0
00004E 8AF2           00111     BSF INTCON,TMR0IE,0     ; Timer0
000050 0012           00112     RETURN
                      00113     
000052                00114 INIT_VARS
000052 0E44           00115     MOVLW   b'01000100'     ; 'D'       Mode Digital
000054 6E02           00116     MOVWF   CASE1,0
000056 0E53           00117     MOVLW   b'01010011'     ; 'S'       Mode Analogic Single
000058 6E03           00118     MOVWF   CASE2,0
00005A 0E54           00119     MOVLW   b'01010100'     ; 'T'       Mode Analogic Real-Time
00005C 6E04           00120     MOVWF   CASE3,0
00005E 0E55           00121     MOVLW   b'01010101'     ; 'U'       Mode Singleshot
000060 6E05           00122     MOVWF   CASE4,0
000062 0E41           00123     MOVLW   b'01000001'     ; 'A'       Mode Auto
000064 6E06           00124     MOVWF   CASE5,0
000066 0E49           00125     MOVLW   b'01001001'     ; 'I'       Inserir nom
000068 6E07           00126     MOVWF   CASE6,0
00006A 0E52           00127     MOVLW   b'01010010'     ; 'R'       Mostrar nom i 200 mesures
00006C 6E08           00128     MOVWF   CASE7,0
00006E 0E4D           00129     MOVLW   b'01001101'     ; 'M'       Mostrar última mesura
000070 6E09           00130     MOVWF   CASE8,0
000072 0E4E           00131     MOVLW   b'01001110'     ; 'N'       Mode Auto-scan
000074 6E10           00132     MOVWF   CASE9,0
000076 6A14           00133     CLRF    nTIMES,0
000078 6A15           00134     CLRF    PWM_FIRST_TIME,0
00007A 6A18           00135     CLRF    MODE,0
00007C 6A19           00136     CLRF    SECONDS_ECHO,0
00007E 6A30           00137     CLRF    POS_REALTIME,0
000080 6A31           00138     CLRF    JT_UP,0
000082 6A32           00139     CLRF    JT_DOWN,0
000084 6A33           00140     CLRF    NUM7,0
000086 6A34           00141     CLRF    nLETRAS,0
000088 6A35           00142     CLRF    nLETRAS_AUX,0
00008A 6A37           00143     CLRF    INIT_AUTO,0
00008C 6A42           00144     CLRF    MESURA,0
00008E 6A43           00145     CLRF    MESURA_AUX,0
000090 6A46           00146     CLRF    CENTENAS,0
000092 6A45           00147     CLRF    DECENAS,0
000094 6A44           00148     CLRF    UNITATS,0
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000096 6A47           00149     CLRF    POS_RAM,0
000098 6A49           00150     CLRF    HAY_MUESTRA,0
00009A 6A50           00151     CLRF    NOM_GUARDAT,0
00009C 6A54           00152     CLRF    AUTO_ACTIVAT,0
00009E 6A53           00153     CLRF    FER_MESURA_SINGLE,0
0000A0 6A55           00154     CLRF    AGAFA_MESURES,0
0000A2 0E0D           00155     MOVLW   .13
0000A4 6E41           00156     MOVWF   ENTER,0
0000A6 0EFF           00157     MOVLW   .255
0000A8 6E38           00158     MOVWF   EEPROM_SIZE,0
0000AA 0E0A           00159     MOVLW   .10
0000AC 6E39           00160     MOVWF   SALTO_LINEA
0000AE 0E2D           00161     MOVLW   .45
0000B0 6E40           00162     MOVWF   GUION
0000B2 0012           00163     RETURN
                      00164     
0000B4                00165 INIT_POINTERS   ; Iniciem punter taula Flash
0000B4 6AF8           00166     CLRF    TBLPTRU,0
0000B6 6AF7           00167     CLRF    TBLPTRH,0
0000B8 0E20           00168     MOVLW   TAULA7S
0000BA 6EF6           00169     MOVWF   TBLPTRL,0
0000BC 0008           00170     TBLRD*
0000BE CFF5 FF8C      00171     MOVFF   TABLAT,LATD
0000C2 0012           00172     RETURN
                      00173     
0000C4                00174 INIT_EUSART
0000C4 0E24           00175     MOVLW   b'00100100' ;Valores TXSTA
0000C6 6EAC           00176     MOVWF   TXSTA,0
0000C8 0E90           00177     MOVLW   b'10010000' ;Valores RCSTA
0000CA 6EAB           00178     MOVWF   RCSTA,0
0000CC 0E02           00179     MOVLW   b'00000010' ;Valores BAUDCON
0000CE 6EB8           00180     MOVWF   BAUDCON,0
0000D0 0EFF           00181     MOVLW   .255        ; SYNC 0, BRGH = 1, BRG16 = 0, 40Mhz --> 255
0000D2 6EAF           00182     MOVWF   SPBRG,0
0000D4 0012           00183     RETURN
                      00184 
0000D6                00185 INIT_T0 ; Congigura Timer0
0000D6 0E91           00186     MOVLW   b'10010001' ;Valores TOCON
0000D8 6ED5           00187     MOVWF   T0CON,0
0000DA 0E3C           00188     MOVLW   HIGH(.15536)
0000DC 6ED7           00189     MOVWF   TMR0H,0
0000DE 0EB0           00190     MOVLW   LOW(.15536)
0000E0 6ED6           00191     MOVWF   TMR0L,0
0000E2 0012           00192     RETURN
                      00193     
0000E4                00194 INIT_ADC ; Configura el módul A/D
0000E4 0E01           00195     MOVLW   b'00000001' ; A/D Input channel
0000E6 6EC2           00196     MOVWF   ADCON0,0
0000E8 0E0E           00197     MOVLW   b'00001110' ; A/D Adquisition time
0000EA 6EC1           00198     MOVWF   ADCON1,0
0000EC 0E09           00199     MOVLW   b'00001001' ; A/D Conversion time
0000EE 6EC0           00200     MOVWF   ADCON2,0
0000F0 0012           00201     RETURN
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00202     
0000F2                00203 INIT_EEPROM
0000F2 C040 FFA8      00204     MOVFF   GUION,EEDATA        ; Data Memory Value to write
0000F6 84A6           00205     BSF     EECON1, WREN        ; Enable writes
0000F8 9EF2           00206     BCF     INTCON, GIE         ; Disable Interrupts
0000FA 0E55           00207     MOVLW   55h
0000FC 6EA7           00208     MOVWF   EECON2              ; Write 55h
0000FE 0EAA           00209     MOVLW   0AAh
000100 6EA7           00210     MOVWF   EECON2              ; Write 0AAh
000102 82A6           00211     BSF     EECON1, WR          ; Set WR bit to begin write
000104                00212 ESPERA_EE
000104 B2A6           00213     BTFSC   EECON1,WR,0
000106 EF?? F???      00214     GOTO    ESPERA_EE
00010A 8EF2           00215     BSF     INTCON, GIE         ; Enable Interrupts
00010C 94A6           00216     BCF     EECON1, WREN        ; Disable writes on write complete (EEIF set)
00010E 2AA9           00217     INCF    EEADR,1,0
000110 2E38           00218     DECFSZ  EEPROM_SIZE,1,0
000112 EF?? F???      00219     GOTO    INIT_EEPROM
000116 0012           00220     RETURN
                      00221     
000118                00222 CARREGA_RAM             ;Inicialitzem els punters de la RAM.
000118 6AE9           00223     CLRF    FSR0L,0
00011A 0E01           00224     MOVLW   0x01
00011C 6EEA           00225     MOVWF   FSR0H,0
00011E                00226 LOOP_RAM                ;Bucle per a l?escriptura de la RAM.
00011E C040 FFEE      00227     MOVFF   GUION,POSTINC0  ;Escribim un '-' en les 200 primeres adreces.
000122 2A47           00228     INCF    POS_RAM,1,0
000124 0EC8           00229     MOVLW   .200
000126 6447           00230     CPFSGT  POS_RAM,0 
000128 EF?? F???      00231     GOTO    LOOP_RAM
00012C 6AE9           00232     CLRF    FSR0L,0         ;Una vegada s?han guardat totes les dades
00012E 0E01           00233     MOVLW   0x01            ;es tornen a inicialitzar els punters. 
000130 6EEA           00234     MOVWF   FSR0H,0
000132 6A47           00235     CLRF    POS_RAM,0
000134 0012           00236     RETURN
                      00237     
                      00238 ; ------------------------------------------------------------------------------
                      00239 ; Quan detectem una interrupció, baixem el flag i anem a al procediment adecuat.
000136                00240 HIGH_RSI 
000136 B4F2           00241     BTFSC   INTCON,TMR0IF
000138 EF?? F???      00242     GOTO    RSI_T0
00013C 0011           00243     RETFIE  FAST   
                      00244    
00013E                00245 RSI_T0 ; Interrupción T0 --> Generem un senyal de 20 ms de període.
00013E 0E3C           00246     MOVLW   HIGH(.15536)
000140 6ED7           00247     MOVWF   TMR0H,0
000142 0EB0           00248     MOVLW   LOW(.15536)
000144 6ED6           00249     MOVWF   TMR0L,0
000146 94F2           00250     BCF     INTCON,TMR0IF,0
000148 2A17           00251     INCF    REBOTS,1,0
00014A 888A           00252     BSF     LATB,4,0
00014C 0EA5           00253     MOVLW   .165      
00014E 6E11           00254     MOVWF   PART_LOW
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000150 0E0A           00255     MOVLW   .10          
000152 6E12           00256     MOVWF   PART_HIGH
000154                00257 LOOP_SERVO ; Determinem el temps a 1 del nostre senyal PWM.
000154 2E11           00258     DECFSZ  PART_LOW,1,0
000156 EF?? F???      00259     GOTO    LOOP_SERVO
00015A 0EA5           00260     MOVLW   .165
00015C 6E11           00261     MOVWF   PART_LOW
00015E 2E12           00262     DECFSZ  PART_HIGH,1,0
000160 EF?? F???      00263     GOTO    LOOP_SERVO
000164 B015           00264     BTFSC   PWM_FIRST_TIME,0,0
000166 EC?? F???      00265     CALL    POS_SERVO
00016A 988A           00266     BCF     LATB,4,0
00016C B055           00267     BTFSC   AGAFA_MESURES,0         ; Comprovem si mode Auto està activat i hem de agafar mostres.
00016E EC?? F???      00268     CALL    MESURE                  ; Si ho està fem un Mesure cada 20ms.
000172 0011           00269     RETFIE  FAST
                      00270     
000174                00271 HUMANS
000174 6A47           00272     CLRF    POS_RAM,0
000176 6AE9           00273     CLRF    FSR0L,0
000178 0012           00274     RETURN
                      00275     
00017A                00276 MESURE
00017A EC?? F???      00277     CALL    PULSE_10uS
00017E 2A47           00278     INCF    POS_RAM,1,0
000180 0EC8           00279     MOVLW   .200
000182 6047           00280     CPFSLT  POS_RAM,0
000184 EC?? F???      00281     CALL    HUMANS
000188 C019 FFEE      00282     MOVFF   SECONDS_ECHO,POSTINC0
00018C 6849           00283     SETF    HAY_MUESTRA,0           ; Marquem que ja hem fet una mostra
00018E 0012           00284     RETURN
                      00285     
000190                00286 PULSE_10uS          ; Procediment d?espera
000190 6A19           00287     CLRF    SECONDS_ECHO,0
000192 828B           00288     BSF     LATC,1,0
000194 0E20           00289     MOVLW   .32
000196 6E00           00290     MOVWF   COUNT_PWM       ; Comptador <- W (Comptador)
000198                00291 ESPERA_10uS
000198 2E00           00292     DECFSZ  COUNT_PWM,1,0
00019A EF?? F???      00293     GOTO    ESPERA_10uS
00019E 928B           00294     BCF     LATC,1,0
0001A0 EC?? F???      00295     CALL    ECHO
0001A4 0012           00296     RETURN
                      00297 
0001A6                00298 ECHO                ; Procediment d?espera
                      00299     ;BTFSS   PORTC,0,0
0001A6 0E42           00300     MOVLW   .66      
0001A8 6E11           00301     MOVWF   PART_LOW
0001AA 0E6E           00302     MOVLW   .110          
0001AC 6E12           00303     MOVWF   PART_HIGH
Warning[207]: Found label after column 1. (LOOP_ECHO_2)
0001AE                00304     LOOP_ECHO_2 ; Determinem el temps a 1 del nostre senyal PWM.
0001AE 2E11           00305     DECFSZ  PART_LOW,1,0
0001B0 EF?? F???      00306     GOTO    LOOP_ECHO_2
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0001B4 0E42           00307     MOVLW   .66
0001B6 6E11           00308     MOVWF   PART_LOW
0001B8 2E12           00309     DECFSZ  PART_HIGH,1,0
0001BA EF?? F???      00310     GOTO    LOOP_ECHO_2
                      00311     ;GOTO    ECHO
0001BE                00312 LOOP_ECHO
0001BE A082           00313     BTFSS   PORTC,0,0 
0001C0 0012           00314     RETURN
0001C2 0EC0           00315     MOVLW   .192
0001C4 6E01           00316     MOVWF   COUNT_PWM1      ; Comptador <- W (Comptador)
0001C6                00317 ESPERA_58uS
0001C6 2E01           00318     DECFSZ  COUNT_PWM1,1,0
0001C8 EF?? F???      00319     GOTO    ESPERA_58uS
0001CC 2A19           00320     INCF    SECONDS_ECHO,1,0
0001CE EF?? F???      00321     GOTO    LOOP_ECHO
                      00322     
0001D2                00323 ESPERA_REBOTS
0001D2 6A17           00324     CLRF    REBOTS,0
0001D4                00325 ESPERA
0001D4 0E0A           00326     MOVLW   .10
0001D6 6217           00327     CPFSEQ  REBOTS,0
0001D8 EF?? F???      00328     GOTO    ESPERA
0001DC 0012           00329     RETURN
                      00330 
0001DE                00331 NUM_7S      ; Mostrem Número del Mode per el display 7-Segments
0001DE 6E33           00332     MOVWF   NUM7,0
0001E0 6AF8           00333     CLRF    TBLPTRU,0
0001E2 6AF7           00334     CLRF    TBLPTRH,0
0001E4 0E20           00335     MOVLW   TAULA7S
0001E6 6EF6           00336     MOVWF   TBLPTRL,0
0001E8                00337 LOOP_NUM7   ; Segons el número del mode incrementem les direccions de la taula flash.
0001E8 2AF6           00338     INCF    TBLPTRL,1,0
0001EA 2E33           00339     DECFSZ  NUM7,1,0
0001EC EF?? F???      00340     GOTO    LOOP_NUM7
0001F0 0008           00341     TBLRD*
0001F2 CFF5 FF8C      00342     MOVFF   TABLAT,LATD
0001F6 0012           00343     RETURN
                      00344     
0001F8                00345 SALTO_Y_ENTER
0001F8 C039 FFAD      00346     MOVFF   SALTO_LINEA, TXREG  ; Fem un salt de línea
0001FC EC?? F???      00347     CALL    WAIT_TX
000200 C041 FFAD      00348     MOVFF   ENTER, TXREG        ; Fem un retorn de carro
000204 EC?? F???      00349     CALL    WAIT_TX
000208 0012           00350     RETURN
                      00351     
                      00352 ; MODES ------------------------------------------------------------------------
                      00353     
                      00354 ; Escriu en la EEPROM el nom i cognom que introdueix l'usuari per el canal série. (max. 120 caràcters)
00020A                00355 MODE_INSERIR_NOM
                      00356     ; Primer de tot mostrem un '0' per el display 7-Segments.
00020A 0E00           00357     MOVLW   .0
00020C EC?? F???      00358     CALL    NUM_7S
000210 6850           00359     SETF    NOM_GUARDAT,0           ; Flag marcant que hem guardat un nom.
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000212 EC?? F???      00360     CALL    SALTO_Y_ENTER           ; Fem salt de línea i retorn de carro.
000216 6A34           00361     CLRF    nLETRAS,0
000218 6A36           00362     CLRF    EXIT_WR
00021A 0E00           00363     MOVLW   0x00
00021C 6EA9           00364     MOVWF   EEADR                   ; Data Memory Address to write
00021E                00365 LOOP_ESCRIPTURA                     ; Esperem a tenir una lletra
00021E AA9E           00366     BTFSS   PIR1,RCIF,0
000220 EF?? F???      00367     GOTO    LOOP_ESCRIPTURA
000224 EC?? F???      00368     CALL    CHECK_ENTER             ; Hem de comprovar que la lletra no sigui un ENTER
000228 EC?? F???      00369     CALL    CHECK_MAX_CARACTER      ; Comprobem si hem arribat al màxim de caracters.
00022C A036           00370     BTFSS   EXIT_WR,0,0             ; Comprovem si hem de sortir de la escriptura
00022E EF?? F???      00371     GOTO    ESCRIBE_LETRA           ; Si no sortim de la escriptura seguim.
000232 EC?? F???      00372     CALL    SALTO_Y_ENTER           ; Fem salt de línea i retorn de carro.
000236 0012           00373     RETURN
                      00374     
000238                00375 CHECK_ENTER             ; Comprovar si la lletra introduida és un 'ENTER'.
000238 50AE           00376     MOVF    RCREG,0
00023A 6241           00377     CPFSEQ  ENTER,0
00023C 0012           00378     RETURN
00023E 6836           00379     SETF    EXIT_WR,0
000240 0012           00380     RETURN
                      00381     
000242                00382 CHECK_MAX_CARACTER      ; Comprovem que no haguem escrit 120 caràcters. (màxim)
000242 0E78           00383     MOVLW   .120
000244 6234           00384     CPFSEQ  nLETRAS,0
000246 0012           00385     RETURN
000248 6836           00386     SETF    EXIT_WR,0
00024A 0012           00387     RETURN
                      00388     
00024C                00389 ESCRIBE_LETRA           ; Guardem la lletra escrita en la memòria EEPROM
00024C 2A34           00390     INCF    nLETRAS,1,0
00024E CFAE FFAD      00391     MOVFF   RCREG, TXREG
000252 EC?? F???      00392     CALL    WAIT_TX
000256 CFAE FFA8      00393     MOVFF   RCREG,EEDATA    ; Data Memory Value to write
00025A 84A6           00394     BSF     EECON1, WREN    ; Enable writes
00025C 9EF2           00395     BCF     INTCON, GIE     ; Disable Interrupts
00025E 0E55           00396     MOVLW   55h
000260 6EA7           00397     MOVWF   EECON2          ; Write 55h
000262 0EAA           00398     MOVLW   0AAh
000264 6EA7           00399     MOVWF   EECON2          ; Write 0AAh
000266 82A6           00400     BSF     EECON1, WR      ; Set WR bit to begin write
000268                00401 ESPERA_EE1
000268 B2A6           00402     BTFSC   EECON1,WR,0
00026A EF?? F???      00403     GOTO    ESPERA_EE1
00026E 8EF2           00404     BSF     INTCON, GIE     ; Enable Interrupts
000270 94A6           00405     BCF     EECON1, WREN    ; Disable writes on write complete (EEIF set)
000272 2AA9           00406     INCF    EEADR,1,0
000274 EF?? F???      00407     GOTO    LOOP_ESCRIPTURA
                      00408 
                      00409     
                      00410 ;-------------------------------------------------------------------------------
                      00411 
                      00412     
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00413 ; Mostra el nom i cognom del usuari guardat en la EEPROM i les últimes 200 mesures de distància guardade
                            s en la memòria RAM que s'han fet. (o les que tinguem si són < 200)
000278                00414 MODE_MOSTRA_NOM
                      00415     ; Primer de tot mostrem un '1' per el display 7-Segments.
000278 0E01           00416     MOVLW   .1
00027A EC?? F???      00417     CALL    NUM_7S
00027E A050           00418     BTFSS   NOM_GUARDAT,0,0     ; Comprovem si tenim un nom guardat.
000280 0012           00419     RETURN              ; Sino, no mostrem res.
000282 EC?? F???      00420     CALL    SALTO_Y_ENTER       ; Fem salt de línea i retorn de carro.
000286 EC?? F???      00421     CALL    MOSTRA_NOM          ; Mostrem nom guardat.
00028A EC?? F???      00422     CALL    SALTO_Y_ENTER       ; Fem salt de línea i retorn de carro.
00028E EC?? F???      00423     CALL    MOSTRAR_200_MESURES ; Mostrem les 200 mesures (o les que tinguem)
000292 0012           00424     RETURN  
                      00425     
000294                00426 MOSTRA_NOM
000294 0E00           00427     MOVLW   0x00
000296 6EA9           00428     MOVWF   EEADR               ; Data Memory Address to read
000298 9EA6           00429     BCF     EECON1, EEPGD       ; Point to DATA memory
00029A 9CA6           00430     BCF     EECON1, CFGS        ; Access EEPROM
00029C C034 F035      00431     MOVFF   nLETRAS,nLETRAS_AUX ; Guardem les , lletres que tenim en una auxiliar.
0002A0                00432 LOOP_LECTURA_EEPROM
0002A0 80A6           00433     BSF     EECON1, RD          ; EEPROM Read
0002A2 CFA8 FFAD      00434     MOVFF   EEDATA, TXREG       ; W = EEDATA
0002A6 EC?? F???      00435     CALL    WAIT_TX
0002AA 2AA9           00436     INCF    EEADR,1,0
0002AC 2E35           00437     DECFSZ  nLETRAS_AUX,1,0
0002AE EF?? F???      00438     GOTO    LOOP_LECTURA_EEPROM
0002B2 0012           00439     RETURN
                      00440     
0002B4                00441 MOSTRAR_200_MESURES
0002B4 0E00           00442     MOVLW   .0
0002B6 6447           00443     CPFSGT  POS_RAM,0
0002B8 0012           00444     RETURN
0002BA 6A48           00445     CLRF    POS_RAM_AUX,0
0002BC C048 FFE9      00446     MOVFF   POS_RAM_AUX,FSR0L
0002C0 0E01           00447     MOVLW   0x01
0002C2 6EEA           00448     MOVWF   FSR0H,0
0002C4                00449 LOOP_LECTURA_RAM
0002C4 CFEE F042      00450     MOVFF   POSTINC0,MESURA
0002C8 2A48           00451     INCF    POS_RAM_AUX,1,0
0002CA EC?? F???      00452     CALL    CONVERT_CHAR_ASCII  ; Hem de convertir la mesura que en fet per a mostrar els centímentres e
                            n ASCII per el canal série.
0002CE C043 F044      00453     MOVFF   MESURA_AUX,UNITATS  ; Mesura_AUX serán les unitats que ens quedin.
0002D2 EC?? F???      00454     CALL    MOSTRAR_MESURA      ; Mostrem mesura actual
0002D6 5047           00455     MOVF    POS_RAM,0
0002D8 6248           00456     CPFSEQ  POS_RAM_AUX,0
0002DA EC?? F???      00457     CALL    SI_GUION            ; Mostrem un guió entre mesures.
0002DE 5047           00458     MOVF    POS_RAM,0
0002E0 6248           00459     CPFSEQ  POS_RAM_AUX,0
0002E2 EF?? F???      00460     GOTO    LOOP_LECTURA_RAM
0002E6 0012           00461     RETURN
                      00462     
0002E8                00463 SI_GUION
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0002E8 C040 FFAD      00464     MOVFF   GUION, TXREG
0002EC EC?? F???      00465     CALL    WAIT_TX
0002F0 0012           00466     RETURN
                      00467     
                      00468     
                      00469 ;-------------------------------------------------------------------------------
                      00470 
                      00471     
                      00472 ; Mostrem l'última mostra realitzada i guardada en la memòria RAM, si no s'ha fet cap mostrem un guió.
0002F2                00473 MODE_MOSTRA_ULTIMA
                      00474     ; Primer de tot mostrem un '2' per el display 7-Segments.
0002F2 0E02           00475     MOVLW   .2
0002F4 EC?? F???      00476     CALL    NUM_7S
0002F8 EC?? F???      00477     CALL    SALTO_Y_ENTER       ; Fem salt de línea i retorn de carro.
0002FC A049           00478     BTFSS   HAY_MUESTRA,0       ; Comprobem si tenim alguna mostra
0002FE EF?? F???      00479     GOTO    NO_MOSTRAR
000302 0647           00480     DECF    POS_RAM,1,0
000304 C047 FFE9      00481     MOVFF   POS_RAM,FSR0L
000308 0E01           00482     MOVLW   0x01
00030A 6EEA           00483     MOVWF   FSR0H,0
00030C CFEE F042      00484     MOVFF   POSTINC0,MESURA
000310 2A47           00485     INCF    POS_RAM,1,0
000312 EC?? F???      00486     CALL    CONVERT_CHAR_ASCII  ; Hem de convertir la mesura que en fet per a mostrar els centímentres e
                            n ASCII per el canal série.
000316 C043 F044      00487     MOVFF   MESURA_AUX,UNITATS  ; Mesura_AUX serán les unitats que ens quedin.
00031A EC?? F???      00488     CALL    MOSTRAR_MESURA      ; Mostrem mesura per el canal serie.
00031E                00489 FINAL_MOSTRA
00031E EC?? F???      00490     CALL    SALTO_Y_ENTER       ; Fem salt de línea i retorn de carro.
000322 0012           00491     RETURN
000324                00492 NO_MOSTRAR                      ; Si no tenim cap mostre mostrem un '-'.
000324 C040 FFAD      00493     MOVFF   GUION, TXREG
000328 EC?? F???      00494     CALL    WAIT_TX
00032C EF?? F???      00495     GOTO    FINAL_MOSTRA
                      00496     
                      00497 ; Funció que treurà cada Xifra de la Mesura i la posarà en ASCII per tal de mostrar-la per el canal séri
                            e.
000330                00498 CONVERT_CHAR_ASCII
000330 C042 F043      00499     MOVFF   MESURA,MESURA_AUX    ; Primer copiem la Mesura que tenim a una variable auxiliar
000334 6A46           00500     CLRF    CENTENAS
000336 6A45           00501     CLRF    DECENAS
000338 6A44           00502     CLRF    UNITATS
00033A 0E64           00503     MOVLW   .100
00033C 6443           00504     CPFSGT  MESURA_AUX,0        ; Comprovem que la mesura sigui > 100 ((sino voldrà dir que no tenim cen
                            tenes)
00033E EF?? F???      00505     GOTO    CALCULAR_DECENAS
000342                00506 LOOP_CENTENAS
000342 0E64           00507     MOVLW   .100
000344 5E43           00508     SUBWF   MESURA_AUX,1        ; Restem 100 a la Mesura                                Ex --> 256-100 =
                             156 ... LOOP
000346 2A46           00509     INCF    CENTENAS            ; Incrementem la Variable de Centenes                   Ex --> LOOP 1..2
                            .
000348 0E65           00510     MOVLW   .101
00034A 6043           00511     CPFSLT  MESURA_AUX,0        ; Si la mesura és més petita de 100 sortim del bucle.   Ex --> Mesura_AU
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            X = 056
00034C EF?? F???      00512     GOTO    LOOP_CENTENAS
000350                00513 CALCULAR_DECENAS
000350 0E09           00514     MOVLW   .9
000352 6443           00515     CPFSGT  MESURA_AUX,0        ; Comprovem que la mesura_aux sigui > 10 (sino voldrà dir que no tenim d
                            ecenes)
000354 0012           00516     RETURN
000356                00517 LOOP_DECENAS
000356 0E0A           00518     MOVLW   .10
000358 5E43           00519     SUBWF   MESURA_AUX,1        ; Restem 10 a la Mesura_AUX que estem calculant         Ex --> 056-10 = 
                            046 ... 035 ... LOOP
00035A 2A45           00520     INCF    DECENAS             ; Incrementem la Variable de Decenes                    Ex --> 1..2..3..
                            4..5.
00035C 0E0A           00521     MOVLW   .10                 
00035E 6043           00522     CPFSLT  MESURA_AUX,0        ; Si la mesura és més petita de 10 sortim del bucle.    Ex --> Mesura_AU
                            X = 006
000360 EF?? F???      00523     GOTO    LOOP_DECENAS
000364 0012           00524     RETURN
                      00525     
000366                00526 MOSTRAR_MESURA
000366 0E30           00527     MOVLW   .48 
000368 2646           00528     ADDWF   CENTENAS,1          ; Sumem 48 a les centenes per a mostrar en ASCII.
00036A C046 FFAD      00529     MOVFF   CENTENAS,TXREG      ; Mostrem xifra de les centenes per el canal série.
00036E EC?? F???      00530     CALL    WAIT_TX
000372 0E30           00531     MOVLW   .48                 
000374 2645           00532     ADDWF   DECENAS,1           ; Sumem 48 a les decenes per a mostrar en ASCII.
000376 C045 FFAD      00533     MOVFF   DECENAS,TXREG       ; Mostrem xifra de les decenes per el canal série.
00037A EC?? F???      00534     CALL    WAIT_TX
00037E 0E30           00535     MOVLW   .48
000380 2644           00536     ADDWF   UNITATS,1           ; Sumem 48 a les unitats per a mostrar en ASCII.
000382 C044 FFAD      00537     MOVFF   UNITATS ,TXREG      ; Mostrem xifra de les unitats per el canal série.
000386 EC?? F???      00538     CALL    WAIT_TX
00038A 0012           00539     RETURN
                      00540     
                      00541     
                      00542 ;-------------------------------------------------------------------------------
                      00543     
                      00544 
                      00545 ; Utilitzarem els botóns per incrementar o decrementar la posició del Servomotor en 5º.
00038C                00546 MODE_DIGITAL
                      00547     ; Primer de tot mostrem un '3' per el display 7-Segments.
00038C 0E03           00548     MOVLW   .3
00038E EC?? F???      00549     CALL    NUM_7S
000392                00550 LOOP_DIGITAL ; Polling entre els els 2 botons i rebre una tecla per el canal serie.
000392 A081           00551     BTFSS   PORTB,0,0           ; Esperem a que es premi el polsador +.
000394 EC?? F???      00552     CALL    INCREMENTA_GRAUS    ; Increment de 5 graus.
000398 A281           00553     BTFSS   PORTB,1,0           ; Esperem a que es premi el polsador -.
00039A EC?? F???      00554     CALL    DECREMENTA_GRAUS    ; Decrement de 5 graus.
00039E A481           00555     BTFSS   PORTB,2,0           ; Esperem a que es premi el polsador MESURE.
0003A0 EC?? F???      00556     CALL    CHECK_MESURE        ; Hem de comprobar si tenim algun mode de Mesura activat, i si en tenim,
                             quin.
0003A4 AA9E           00557     BTFSS   PIR1,RCIF,0         ; Esperem a que es premi una altre tecla per el canal serie.
0003A6 EF?? F???      00558     GOTO    LOOP_DIGITAL        ; Si no tenim cap tecla seguim en el mateix mode.
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0003AA EF?? F???      00559     GOTO    CHECK_MODE 
                      00560     
                      00561     
                      00562 ;-------------------------------------------------------------------------------
                      00563     
                      00564     
                      00565 ; Utilitzarem el joystick per incrementar o decrementar la posició del Servomotor en 5º.
0003AE                00566 MODE_ANALOGIC_SINGLE
                      00567     ; Primer de tot mostrem un '4' per el display 7-Segments.
0003AE 0E04           00568     MOVLW   .4
0003B0 EC?? F???      00569     CALL    NUM_7S
0003B4                00570 LOOP_ANALOGIC_SINGLE 
0003B4 82C2           00571     BSF     ADCON0,GO_NOT_DONE,0
0003B6                00572 WAIT_ADC
0003B6 B2C2           00573     BTFSC   ADCON0,GO_NOT_DONE,0
0003B8 EF?? F???      00574     GOTO    WAIT_ADC
0003BC EC?? F???      00575     CALL    CHECK_JOYSTICK              ; Comprovem posició Joystick
0003C0 A481           00576     BTFSS   PORTB,2,0                   ; Esperem a que es premi el polsador MESURE.
0003C2 EC?? F???      00577     CALL    CHECK_MESURE                ; Hem de comprobar si tenim algun mode de Mesura activat, i si e
                            n tenim, quin.
0003C6 AA9E           00578     BTFSS   PIR1,RCIF,0                 ; Esperem a que es premi una altre tecla per el canal serie.
0003C8 EF?? F???      00579     GOTO    LOOP_ANALOGIC_SINGLE        ; Si no tenim cap tecla seguim en el mateix mode.
0003CC EF?? F???      00580     GOTO    CHECK_MODE                  ; Si no tenim cap tecla seguim en el mateix mode.
                      00581     
                      00582 
                      00583 ;-------------------------------------------------------------------------------
                      00584     
                      00585 
                      00586 ; Col·loquem el servomotor en la mateixa posició analógica del joystick actualitzant el gir a temps real
                            .
0003D0                00587 MODE_ANALOGIC_REALTIME
                      00588     ; Primer de tot mostrem un '5' per el display 7-Segments.
0003D0 0E05           00589     MOVLW   .5
0003D2 EC?? F???      00590     CALL    NUM_7S
0003D6                00591 LOOP_ANALOGIC_REALTIME
0003D6 8015           00592     BSF     PWM_FIRST_TIME,0,0
0003D8 0E0A           00593     MOVLW   b'00001010' ; A/D Conversion time
0003DA 6EC0           00594     MOVWF   ADCON2,0
0003DC 82C2           00595     BSF     ADCON0,GO_NOT_DONE,0
0003DE                00596 WAIT_ADC2
0003DE B2C2           00597     BTFSC   ADCON0,GO_NOT_DONE,0
0003E0 EF?? F???      00598     GOTO    WAIT_ADC2
0003E4 CFC4 F030      00599     MOVFF   ADRESH, POS_REALTIME        ; Agafem 5 bits del High.
0003E8 4230           00600     RRNCF   POS_REALTIME,1,0            ; Rotem tres cops els bits.
0003EA 4230           00601     RRNCF   POS_REALTIME,1,0
0003EC 4230           00602     RRNCF   POS_REALTIME,1,0
0003EE 0E1F           00603     MOVLW   b'00011111'
0003F0 1630           00604     ANDWF   POS_REALTIME,1
0003F2 0E05           00605     MOVLW   .5
0003F4 0230           00606     MULWF   POS_REALTIME,0
0003F6 CFF3 F014      00607     MOVFF   PRODL,nTIMES
0003FA A481           00608     BTFSS   PORTB,2,0                   ; Esperem a que es premi el polsador MESURE.
0003FC EC?? F???      00609     CALL    CHECK_MESURE                ; Hem de comprobar si tenim algun mode de Mesura activat, i si e
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            n tenim, quin.
000400 AA9E           00610     BTFSS   PIR1,RCIF,0                 ; Esperem a que es premi una altre tecla per el canal serie.
000402 EF?? F???      00611     GOTO    LOOP_ANALOGIC_REALTIME      ; Si no tenim cap tecla seguim en el mateix mode.
000406 EF?? F???      00612     GOTO    CHECK_MODE                  ; Si no tenim cap tecla seguim en el mateix mode.
                      00613     
                      00614     
                      00615 ; MOURE SERVO ------------------------------------------------------------------
                      00616     
00040A                00617 POS_SERVO       ; Determina posició Servomotor
00040A C014 F016      00618     MOVFF   nTIMES, SERVO_POS
00040E                00619 LOOP_nTIMES
00040E 0E24           00620     MOVLW   .36
000410 6E13           00621     MOVWF   INC_PWM
000412                00622 LOOP_INC_PWM
000412 2E13           00623     DECFSZ  INC_PWM,1,0
000414 EF?? F???      00624     GOTO    LOOP_INC_PWM
000418 2E16           00625     DECFSZ  SERVO_POS,1,0
00041A EF?? F???      00626     GOTO    LOOP_nTIMES
00041E 0012           00627     RETURN
                      00628     
000420                00629 INCREMENTA_GRAUS
000420 EC?? F???      00630     CALL    ESPERA_REBOTS
000424 6A31           00631     CLRF    JT_UP,0
000426 6815           00632     SETF    PWM_FIRST_TIME,0    ; Marquem que ja hem mogut.
000428 0EB0           00633     MOVLW   .176                
00042A 6014           00634     CPFSLT  nTIMES,0            ; Si estem en una posició de menys de 176º podem fer els increments
00042C 0012           00635     RETURN
00042E 2A14           00636     INCF    nTIMES,1            ; Incrementem 5 cops --> 5º
000430 2A14           00637     INCF    nTIMES,1
000432 2A14           00638     INCF    nTIMES,1
000434 2A14           00639     INCF    nTIMES,1
000436 2A14           00640     INCF    nTIMES,1
000438 0012           00641     RETURN
                      00642     
00043A                00643 ZERO
00043A 6A15           00644     CLRF PWM_FIRST_TIME,0
00043C 0012           00645     RETURN
                      00646     
00043E                00647 DECREMENTA_GRAUS
00043E EC?? F???      00648     CALL    ESPERA_REBOTS
000442 6A32           00649     CLRF    JT_DOWN,0
000444 0E04           00650     MOVLW   .4
000446 6414           00651     CPFSGT  nTIMES,0            ; Si estem en una posició de més de 4º podem fer els decrement
000448 EF?? F???      00652     GOTO    ZERO
00044C 0614           00653     DECF    nTIMES,1            ; Decrementem 5 cops --> 5º
00044E 0614           00654     DECF    nTIMES,1
000450 0614           00655     DECF    nTIMES,1
000452 0614           00656     DECF    nTIMES,1
000454 0614           00657     DECF    nTIMES,1
000456 0012           00658     RETURN   
                      00659     
                      00660     
000458                00661 CHECK_JOYSTICK ; Guardem moviments Joystick per a moure el Servo quan torni a la posició de repós.
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000458 0EC8           00662     MOVLW   .200        ; Mirem si la posició del Joystick és < 200. (Sino --> UP)
00045A 60C4           00663     CPFSLT  ADRESH,0
00045C 6831           00664     SETF    JT_UP,0
00045E 0E32           00665     MOVLW   .50         ; Mirem si la posició del Joystick és > 50. (Sino --> DOWN)
000460 64C4           00666     CPFSGT  ADRESH,0
000462 6832           00667     SETF    JT_DOWN,0
000464 0E80           00668     MOVLW   .128        ; Mirem si la posició del Joystick és = 128. (Si --> Centre)
000466 62C4           00669     CPFSEQ  ADRESH,0
000468 0012           00670     RETURN
00046A B031           00671     BTFSC   JT_UP,0     ; Si hem detectat la posició UP incrementem 5º.
00046C EC?? F???      00672     CALL    INCREMENTA_GRAUS
000470 B032           00673     BTFSC   JT_DOWN,0   ; Si hem detectat la posició DOWN decrementem 5º.
000472 EC?? F???      00674     CALL    DECREMENTA_GRAUS
000476 0012           00675     RETURN
                      00676 
                      00677     
                      00678 ;-------------------------------------------------------------------------------
                      00679 
                      00680     
                      00681 ; Realitzarem una sola mostra amb el detector de distàncies (ultrasons).
000478                00682 MODE_SINGLESHOT
                      00683     ; Primer de tot mostrem un '6' per el display 7-Segments.
000478 0E06           00684     MOVLW   .6
00047A EC?? F???      00685     CALL    NUM_7S
00047E 8689           00686     BSF     LATA,3,0            ; Encenem el LED de Status1.
000480 9889           00687     BCF     LATA,4,0            ; Apaguem el LED de Status2.  
000482 6A54           00688     CLRF    AUTO_ACTIVAT,0      ; Netejarem el Flag de mode Auto.
000484 6A55           00689     CLRF    AGAFA_MESURES,0     ; Deixarem de fer mesures Auto.
000486 EC?? F???      00690     CALL    CHECK_SINGLESHOT
00048A 0012           00691     RETURN
                      00692     
00048C                00693 CHECK_SINGLESHOT                        
00048C B253           00694     BTFSC   FER_MESURA_SINGLE,1,0       ; Comprovem si tenim el Mode Singleshot activat.
00048E EC?? F???      00695     CALL    MESURE                      ; Si el tenim, fem la mesura.
000492 6853           00696     SETF    FER_MESURA_SINGLE           ; Si no el tenim actvat, l'activem.
000494 0012           00697     RETURN
                      00698     
000496                00699 CHECK_MESURE    ; Entrarem a aquest mode mitjançant el botó Mesure.
000496 EC?? F???      00700     CALL    ESPERA_REBOTS
00049A B253           00701     BTFSC   FER_MESURA_SINGLE,1,0       ; Comprovem si tenim el Mode Singleshot activat.
00049C EC?? F???      00702     CALL    MESURE                      ; Si el tenim, fem la mesura.
0004A0 B254           00703     BTFSC   AUTO_ACTIVAT,1,0            ; Comprovem si tenim el Mode Auto Activat
0004A2 EC?? F???      00704     CALL    CHECK_MESURES_AUTO          ; Si el tenim comprovem si estem fent mesures o no.
0004A6 0012           00705     RETURN
                      00706     
                      00707 ;-------------------------------------------------------------------------------
                      00708     
                      00709     
                      00710 ; Realitzarem mostres cada 20ms constantment.
0004A8                00711 MODE_AUTO
                      00712     ; Primer de tot mostrem un '7' per el display 7-Segments.
0004A8 0E07           00713     MOVLW   .7
0004AA EC?? F???      00714     CALL    NUM_7S
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0004AE 8689           00715     BSF     LATA,3,0                ; Encenem el LED de Status1.
0004B0 8889           00716     BSF     LATA,4,0                ; Encenem el LED de Status2.
0004B2 6A53           00717     CLRF    FER_MESURA_SINGLE,0     ; Netejarem el flag de Singleshot.
0004B4 EC?? F???      00718     CALL    CHECK_AUTO
0004B8 0012           00719     RETURN
                      00720     
0004BA                00721 CHECK_AUTO
0004BA B254           00722     BTFSC   AUTO_ACTIVAT,1,0        ; Comprovem si tenim el mode Auto activat.
0004BC EC?? F???      00723     CALL    CHECK_MESURES_AUTO      ; Si el tenim, mirem si estem fent mesures o no.
0004C0 6854           00724     SETF    AUTO_ACTIVAT,0          ; Si no el tenim, l'activem.
0004C2 0012           00725     RETURN
                      00726     
0004C4                00727 CHECK_MESURES_AUTO
0004C4 B255           00728     BTFSC   AGAFA_MESURES,1,0       ; Comprovem si estem agafant mesures.
0004C6 EF?? F???      00729     GOTO    APAGA_AUTO              ; Si si, ho desactivem.
0004CA 6855           00730     SETF    AGAFA_MESURES,0         ; Si no, ho activem.
0004CC                00731 FINAL
0004CC 0012           00732     RETURN
                      00733     
0004CE                00734 APAGA_AUTO      ; Deixem de agafar mesures i anem al final sense tornar a activar-les.
0004CE 6A55           00735     CLRF    AGAFA_MESURES,0
0004D0 EF?? F???      00736     GOTO    FINAL    
                      00737     
                      00738 ;-------------------------------------------------------------------------------
                      00739 
                      00740     
                      00741 ; Movem el servo de un en un els 180º i realitzem una mesura en cada grau. Col·loquem el servomotor en l
                            a posició que ha determinat la mesura més gran.
0004D4                00742 MODE_AUTOSCAN
                      00743     ; Primer de tot mostrem un '8' per el display 7-Segments.
0004D4 0E08           00744     MOVLW   .8
0004D6 EC?? F???      00745     CALL    NUM_7S
0004DA 6A14           00746     CLRF    nTIMES,0            ; Ens col·loquem a la posició d'inici del servomotor.
0004DC 6A15           00747     CLRF    PWM_FIRST_TIME,0
0004DE 6A51           00748     CLRF    POS_MAX,0
0004E0 6A52           00749     CLRF    nTIMES_MAX,0
0004E2 6A47           00750     CLRF    POS_RAM,0
0004E4 6AE9           00751     CLRF    FSR0L,0
0004E6                00752 LOOP_AUTOSCAN
0004E6 EC?? F???      00753     CALL    MESURE              ; Realitzem una mesura.
0004EA 6815           00754     SETF    PWM_FIRST_TIME,0    ; Marquem que ja hem mogut.
0004EC 2A14           00755     INCF    nTIMES,1            ; Incrementem 1º la posició.
0004EE 5051           00756     MOVF    POS_MAX,0
0004F0 6019           00757     CPFSLT  SECONDS_ECHO,0      ; Comparem valor de distància actual amb valor màxim guardat.
0004F2 EC?? F???      00758     CALL    SAVE_MAX            ; Guardem Valor de distància màxim i la seva posició. 
0004F6 0EB4           00759     MOVLW   .180
0004F8 6214           00760     CPFSEQ  nTIMES,0            ; Si arribem a 180º hem acabat.
0004FA EF?? F???      00761     GOTO    LOOP_AUTOSCAN
0004FE C052 F014      00762     MOVFF   nTIMES_MAX,nTIMES   ; Un cop acabem movem al servo a la posició on hem trobat el valor de di
                            stància màxim.
000502 0012           00763     RETURN
                      00764     
000504                00765 SAVE_MAX
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000504 C019 F051      00766     MOVFF   SECONDS_ECHO,POS_MAX
000508 C014 F052      00767     MOVFF   nTIMES,nTIMES_MAX
00050C 0012           00768     RETURN
                      00769     
                      00770     
                      00771 ;-------------------------------------------------------------------------------
                      00772     
                      00773     
                      00774 ; Comprovem si hem de canviar de mode segons la lletra que ens han introduït per el canal série.
00050E                00775 CHECK_MODE
00050E CFAE FFAD      00776     MOVFF   RCREG,TXREG
                      00777     
                      00778     ; Primer comprovem que la tecla sigui vàlida i la guardem o anem al mode en concret.
000512 50AE           00779     MOVF    RCREG,0 
000514 1802           00780     XORWF   CASE1,0
000516 B4D8           00781     BTFSC   STATUS,Z
000518 CFAE F018      00782     MOVFF   RCREG, MODE         ; Hem de guardar que estem en el mode Digital.
                      00783     
00051C 50AE           00784     MOVF    RCREG,0
00051E 1803           00785     XORWF   CASE2,0
000520 B4D8           00786     BTFSC   STATUS,Z
000522 CFAE F018      00787     MOVFF   RCREG, MODE         ; Hem de guardar que estem al mode Analogic Single.
                      00788     
000526 50AE           00789     MOVF    RCREG,0
000528 1804           00790     XORWF   CASE3,0
00052A B4D8           00791     BTFSC   STATUS,Z
00052C CFAE F018      00792     MOVFF   RCREG, MODE         ; Hem de guardar que estem al mode Analogic Realtime.
                      00793     
000530 50AE           00794     MOVF    RCREG,0
000532 1805           00795     XORWF   CASE4,0
000534 B4D8           00796     BTFSC   STATUS,Z
000536 EC?? F???      00797     CALL    MODE_SINGLESHOT     ; Hem de anar a mode Singleshot i tornarem al mode anterior (si teniem).
                      00798     
00053A 50AE           00799     MOVF    RCREG,0
00053C 1806           00800     XORWF   CASE5,0
00053E B4D8           00801     BTFSC   STATUS,Z
000540 EC?? F???      00802     CALL    MODE_AUTO           ; Hem de anar a mode Auto i tornarem al mode anterior (si teniem).
                      00803     
000544 50AE           00804     MOVF    RCREG,0
000546 1807           00805     XORWF   CASE6,0
000548 B4D8           00806     BTFSC   STATUS,Z
00054A EC?? F???      00807     CALL    MODE_INSERIR_NOM    ; Hem de anar al mode Inserir Nom, i netejarem els demés modes.
                      00808     
00054E 50AE           00809     MOVF    RCREG,0
000550 1808           00810     XORWF   CASE7,0
000552 B4D8           00811     BTFSC   STATUS,Z
000554 EC?? F???      00812     CALL    MODE_MOSTRA_NOM     ; Hem de anar al mode Mostrar Nom i Mesures, i netejarem els demés modes
                            .
                      00813     
000558 50AE           00814     MOVF    RCREG,0
00055A 1809           00815     XORWF   CASE8,0
00055C B4D8           00816     BTFSC   STATUS,Z
00055E EC?? F???      00817     CALL    MODE_MOSTRA_ULTIMA  ; Hem de anar al mode Mostrar Ultima Mesura, i netejarem els demés modes
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 17


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            .
                      00818     
000562 50AE           00819     MOVF    RCREG,0
000564 1810           00820     XORWF   CASE9,0
000566 B4D8           00821     BTFSC   STATUS,Z
000568 EC?? F???      00822     CALL    MODE_AUTOSCAN       ; Hem de anar al mode Autoscan, i netejarem els demés modes.
                      00823 
                      00824     ; Anem al mode vàlid que s'hagui introduit
00056C 5018           00825     MOVF    MODE,0
00056E 1802           00826     XORWF   CASE1,0
000570 B4D8           00827     BTFSC   STATUS,Z
000572 EF?? F???      00828     GOTO    MODE_DIGITAL            ; Tornarem al Mode Digital si el teniem guardat a la variable.
                      00829     
000576 5018           00830     MOVF    MODE,0
000578 1803           00831     XORWF   CASE2,0
00057A B4D8           00832     BTFSC   STATUS,Z
00057C EF?? F???      00833     GOTO    MODE_ANALOGIC_SINGLE    ; Tornarem al Mode Analogic Single si el teniem guardat a la variabl
                            e.
                      00834     
000580 5018           00835     MOVF    MODE,0
000582 1804           00836     XORWF   CASE3,0
000584 B4D8           00837     BTFSC   STATUS,Z
000586 EF?? F???      00838     GOTO    MODE_ANALOGIC_REALTIME  ; Tornarem al Mode Analogic Realtime si el teniem guardat a la varia
                            ble.
                      00839 
00058A 0012           00840     RETURN
                      00841     
                      00842     
                      00843 ; ------------------------------------------------------------------------------
                      00844 
                      00845     
00058C                00846 WAIT_RX
00058C AA9E           00847     BTFSS   PIR1,RCIF,0     ; Esperem a que es premi una tecla per el canal serie.
00058E EF?? F???      00848     GOTO    WAIT_RX
000592 EC?? F???      00849     CALL    CHECK_MODE      ; Mirarem si hem de fer alguna cosa amb la tecla introduida.
                      00850 
000596                00851 WAIT_TX
000596 A2AC           00852     BTFSS   TXSTA, TRMT,0   ; Esperarem a rebre el valor.
000598 EF?? F???      00853     GOTO    WAIT_TX
00059C 0012           00854     RETURN
                      00855     
00059E                00856 MAIN
00059E EC?? F???      00857     CALL    INIT_PORTS
0005A2 EC?? F???      00858     CALL    INIT_INTERRUPTS
0005A6 EC?? F???      00859     CALL    INIT_T0
0005AA EC?? F???      00860     CALL    INIT_VARS
0005AE EC?? F???      00861     CALL    INIT_POINTERS
0005B2 EC?? F???      00862     CALL    INIT_EUSART
0005B6 EC?? F???      00863     CALL    INIT_ADC
0005BA EC?? F???      00864     CALL    CARREGA_RAM
0005BE EC?? F???      00865     CALL    INIT_EEPROM
0005C2 EC?? F???      00866     CALL    MODE_SINGLESHOT
0005C6 C002 F018      00867     MOVFF   CASE1,MODE
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 18


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0005CA                00868 LOOP
0005CA EC?? F???      00869     CALL    WAIT_RX
0005CE EC?? F???      00870     CALL    WAIT_TX
0005D2 EF?? F???      00871     GOTO    LOOP
                      00872     END
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 19


SYMBOL TABLE
  LABEL                             VALUE 

A                                 00000000
ABDEN                             00000000
ABDOVF                            00000007
ACCESS                            00000000
ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ACQT0                             00000003
ACQT1                             00000004
ACQT2                             00000005
ADCON0                            00000FC2
ADCON1                            00000FC1
ADCON2                            00000FC0
ADCS0                             00000000
ADCS1                             00000001
ADCS2                             00000002
ADDEN                             00000003
ADEN                              00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADIP                              00000006
ADMSK1                            00000001
ADMSK2                            00000002
ADMSK3                            00000003
ADMSK4                            00000004
ADMSK5                            00000005
ADON                              00000000
ADRES                             00000FC3
ADRESH                            00000FC4
ADRESL                            00000FC3
AGAFA_MESURES                     00000055
AN0                               00000000
AN1                               00000001
AN10                              00000001
AN11                              00000004
AN12                              00000000
AN2                               00000002
AN3                               00000003
AN4                               00000005
AN5                               00000000
AN6                               00000001
AN7                               00000002
AN8                               00000002
AN9                               00000003
APAGA_AUTO                        000004CE
AUTO_ACTIVAT                      00000054
BANKED                            00000001
BAUDCON                           00000FB8
BAUDCTL                           00000FB8
BCLIE                             00000003
BCLIF                             00000003
BCLIP                             00000003
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 20


SYMBOL TABLE
  LABEL                             VALUE 

BF                                00000000
BGST                              00000005
BOR                               00000000
BRG16                             00000003
BRGH                              00000002
BSR                               00000FE0
C                                 00000000
C1INV                             00000004
C1N                               00000000
C1OUT_CMCON                       00000006
C1OUT_PORTA                       00000004
C1P                               00000003
C2INV                             00000005
C2N                               00000001
C2OUT_CMCON                       00000007
C2OUT_PORTA                       00000005
C2P                               00000002
CALCULAR_DECENAS                  00000350
CARREGA_RAM                       00000118
CASE1                             00000002
CASE2                             00000003
CASE3                             00000004
CASE4                             00000005
CASE5                             00000006
CASE6                             00000007
CASE7                             00000008
CASE8                             00000009
CASE9                             00000010
CCP1                              00000002
CCP1CON                           00000FBD
CCP1IE                            00000002
CCP1IF                            00000002
CCP1IP                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1X                             00000005
CCP1Y                             00000004
CCP2CON                           00000FBA
CCP2IE                            00000000
CCP2IF                            00000000
CCP2IP                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
CCP2M2                            00000002
CCP2M3                            00000003
CCP2X                             00000005
CCP2Y                             00000004
CCP2_PORTB                        00000003
CCP2_PORTC                        00000001
CCPR1                             00000FBE
CCPR1H                            00000FBF
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 21


SYMBOL TABLE
  LABEL                             VALUE 

CCPR1L                            00000FBE
CCPR2                             00000FBB
CCPR2H                            00000FBC
CCPR2L                            00000FBB
CENTENAS                          00000046
CFGS                              00000006
CHECK_AUTO                        000004BA
CHECK_ENTER                       00000238
CHECK_JOYSTICK                    00000458
CHECK_MAX_CARACTER                00000242
CHECK_MESURE                      00000496
CHECK_MESURES_AUTO                000004C4
CHECK_MODE                        0000050E
CHECK_SINGLESHOT                  0000048C
CHS0                              00000002
CHS1                              00000003
CHS2                              00000004
CHS3                              00000005
CIS                               00000003
CK                                00000006
CKE                               00000006
CKP                               00000004
CLKI                              00000007
CLKO                              00000006
CM0                               00000000
CM1                               00000001
CM2                               00000002
CMCON                             00000FB4
CMIE                              00000006
CMIF                              00000006
CMIP                              00000006
CONVERT_CHAR_ASCII                00000330
COUNT_PWM                         00000000
COUNT_PWM1                        00000001
CREN                              00000004
CS                                00000002
CSRC                              00000007
CVR0                              00000000
CVR1                              00000001
CVR2                              00000002
CVR3                              00000003
CVRCON                            00000FB5
CVREF                             00000002
CVREN                             00000007
CVROE                             00000006
CVRR                              00000005
CVRSS                             00000004
D                                 00000005
DC                                00000001
DC1B0                             00000004
DC1B1                             00000005
DC2B0                             00000004
DC2B1                             00000005
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 22


SYMBOL TABLE
  LABEL                             VALUE 

DDRA                              TRISA
DDRB                              TRISB
DDRC                              TRISC
DDRD                              TRISD
DDRE                              TRISE
DECENAS                           00000045
DECREMENTA_GRAUS                  0000043E
DONE                              00000001
D_A                               00000005
D_NOT_A                           00000005
ECCP1AS                           00000FB6
ECCP1CON                          00000FBD
ECCP1DEL                          00000FB7
ECCPAS0                           00000004
ECCPAS1                           00000005
ECCPAS2                           00000006
ECCPASE                           00000007
ECHO                              000001A6
EEADR                             00000FA9
EECON1                            00000FA6
EECON2                            00000FA7
EEDATA                            00000FA8
EEIE                              00000004
EEIF                              00000004
EEIP                              00000004
EEPGD                             00000007
EEPROM_SIZE                       00000038
ENTER                             00000041
ESCRIBE_LETRA                     0000024C
ESPERA                            000001D4
ESPERA_10uS                       00000198
ESPERA_58uS                       000001C6
ESPERA_EE                         00000104
ESPERA_EE1                        00000268
ESPERA_REBOTS                     000001D2
EXIT_WR                           00000036
FAST                              00000001
FERR                              00000002
FER_MESURA_SINGLE                 00000053
FINAL                             000004CC
FINAL_MOSTRA                      0000031E
FLT0                              00000000
FLTS                              00000002
FREE                              00000004
FSR0                              00000000
FSR0H                             00000FEA
FSR0L                             00000FE9
FSR1                              00000001
FSR1H                             00000FE2
FSR1L                             00000FE1
FSR2                              00000002
FSR2H                             00000FDA
FSR2L                             00000FD9
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 23


SYMBOL TABLE
  LABEL                             VALUE 

GCEN                              00000007
GIE                               00000007
GIEH                              00000007
GIEL                              00000006
GIE_GIEH                          00000007
GO                                00000001
GO_DONE                           00000001
GO_NOT_DONE                       00000001
GUION                             00000040
HAY_MUESTRA                       00000049
HIGH_RSI                          00000136
HLVDCON                           00000FD2
HLVDEN                            00000004
HLVDIE                            00000002
HLVDIF                            00000002
HLVDIN                            00000005
HLVDIP                            00000002
HLVDL0                            00000000
HLVDL1                            00000001
HLVDL2                            00000002
HLVDL3                            00000003
HUMANS                            00000174
IBF                               00000007
IBOV                              00000005
IDLEN                             00000007
INCREMENTA_GRAUS                  00000420
INC_PWM                           00000013
INDF0                             00000FEF
INDF1                             00000FE7
INDF2                             00000FDF
INIT_ADC                          000000E4
INIT_AUTO                         00000037
INIT_EEPROM                       000000F2
INIT_EUSART                       000000C4
INIT_INTERRUPTS                   00000048
INIT_POINTERS                     000000B4
INIT_PORTS                        0000002A
INIT_T0                           000000D6
INIT_VARS                         00000052
INT0                              00000000
INT0E                             00000004
INT0F                             00000001
INT0IE                            00000004
INT0IF                            00000001
INT1                              00000001
INT1E                             00000003
INT1F                             00000000
INT1IE                            00000003
INT1IF                            00000000
INT1IP                            00000006
INT1P                             00000006
INT2                              00000002
INT2E                             00000004
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 24


SYMBOL TABLE
  LABEL                             VALUE 

INT2F                             00000001
INT2IE                            00000004
INT2IF                            00000001
INT2IP                            00000007
INT2P                             00000007
INTCON                            00000FF2
INTCON2                           00000FF1
INTCON3                           00000FF0
INTEDG0                           00000006
INTEDG1                           00000005
INTEDG2                           00000004
INTSRC                            00000007
IOFS                              00000002
IPEN                              00000007
IPR1                              00000F9F
IPR2                              00000FA2
IRCF0                             00000004
IRCF1                             00000005
IRCF2                             00000006
IRVST                             00000005
JT_DOWN                           00000032
JT_UP                             00000031
KBI0                              00000004
KBI1                              00000005
KBI2                              00000006
KBI3                              00000007
LATA                              00000F89
LATA0                             00000000
LATA1                             00000001
LATA2                             00000002
LATA3                             00000003
LATA4                             00000004
LATA5                             00000005
LATA6                             00000006
LATA7                             00000007
LATB                              00000F8A
LATB0                             00000000
LATB1                             00000001
LATB2                             00000002
LATB3                             00000003
LATB4                             00000004
LATB5                             00000005
LATB6                             00000006
LATB7                             00000007
LATC                              00000F8B
LATC0                             00000000
LATC1                             00000001
LATC2                             00000002
LATC3                             00000003
LATC4                             00000004
LATC5                             00000005
LATC6                             00000006
LATC7                             00000007
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 25


SYMBOL TABLE
  LABEL                             VALUE 

LATD                              00000F8C
LATD0                             00000000
LATD1                             00000001
LATD2                             00000002
LATD3                             00000003
LATD4                             00000004
LATD5                             00000005
LATD6                             00000006
LATD7                             00000007
LATE                              00000F8D
LATE0                             00000000
LATE1                             00000001
LATE2                             00000002
LOOP                              000005CA
LOOP_ANALOGIC_REALTIME            000003D6
LOOP_ANALOGIC_SINGLE              000003B4
LOOP_AUTOSCAN                     000004E6
LOOP_CENTENAS                     00000342
LOOP_DECENAS                      00000356
LOOP_DIGITAL                      00000392
LOOP_ECHO                         000001BE
LOOP_ECHO_2                       000001AE
LOOP_ESCRIPTURA                   0000021E
LOOP_INC_PWM                      00000412
LOOP_LECTURA_EEPROM               000002A0
LOOP_LECTURA_RAM                  000002C4
LOOP_NUM7                         000001E8
LOOP_RAM                          0000011E
LOOP_SERVO                        00000154
LOOP_nTIMES                       0000040E
LVDCON                            00000FD2
LVDEN                             00000004
LVDIE                             00000002
LVDIF                             00000002
LVDIP                             00000002
LVDL0                             00000000
LVDL1                             00000001
LVDL2                             00000002
LVDL3                             00000003
LVV0                              00000000
LVV1                              00000001
LVV2                              00000002
LVV3                              00000003
MAIN                              0000059E
MCLR                              00000003
MESURA                            00000042
MESURA_AUX                        00000043
MESURE                            0000017A
MODE                              00000018
MODE_ANALOGIC_REALTIME            000003D0
MODE_ANALOGIC_SINGLE              000003AE
MODE_AUTO                         000004A8
MODE_AUTOSCAN                     000004D4
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 26


SYMBOL TABLE
  LABEL                             VALUE 

MODE_DIGITAL                      0000038C
MODE_INSERIR_NOM                  0000020A
MODE_MOSTRA_NOM                   00000278
MODE_MOSTRA_ULTIMA                000002F2
MODE_SINGLESHOT                   00000478
MOSTRAR_200_MESURES               000002B4
MOSTRAR_MESURA                    00000366
MOSTRA_NOM                        00000294
N                                 00000004
NOM_GUARDAT                       00000050
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BOR                           00000000
NOT_CS                            00000002
NOT_DONE                          00000001
NOT_MCLR                          00000003
NOT_PD                            00000002
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RD                            00000000
NOT_RI                            00000004
NOT_SS                            00000005
NOT_T1SYNC                        00000002
NOT_T3SYNC                        00000002
NOT_TO                            00000003
NOT_W                             00000002
NOT_WR                            00000001
NOT_WRITE                         00000002
NO_MOSTRAR                        00000324
NUM7                              00000033
NUM_7S                            000001DE
OBF                               00000006
OERR                              00000001
OSC1                              00000007
OSC2                              00000006
OSCCON                            00000FD3
OSCFIE                            00000007
OSCFIF                            00000007
OSCFIP                            00000007
OSCTUNE                           00000F9B
OSTS                              00000003
OV                                00000003
P                                 00000004
P1A                               00000002
P1B                               00000005
P1C                               00000006
P1D                               00000007
P1M0                              00000006
P1M1                              00000007
PART_HIGH                         00000012
PART_LOW                          00000011
PC                                00000FF9
PCFG0                             00000000
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 27


SYMBOL TABLE
  LABEL                             VALUE 

PCFG1                             00000001
PCFG2                             00000002
PCFG3                             00000003
PCL                               00000FF9
PCLATH                            00000FFA
PCLATU                            00000FFB
PD                                00000002
PDC0                              00000000
PDC1                              00000001
PDC2                              00000002
PDC3                              00000003
PDC4                              00000004
PDC5                              00000005
PDC6                              00000006
PEIE                              00000006
PEIE_GIEL                         00000006
PEN                               00000002
PGC                               00000006
PGD                               00000007
PGM                               00000005
PIE1                              00000F9D
PIE2                              00000FA0
PIR1                              00000F9E
PIR2                              00000FA1
PLLEN                             00000006
PLUSW0                            00000FEB
PLUSW1                            00000FE3
PLUSW2                            00000FDB
POR                               00000001
PORTA                             00000F80
PORTB                             00000F81
PORTC                             00000F82
PORTD                             00000F83
PORTE                             00000F84
POSTDEC0                          00000FED
POSTDEC1                          00000FE5
POSTDEC2                          00000FDD
POSTINC0                          00000FEE
POSTINC1                          00000FE6
POSTINC2                          00000FDE
POS_MAX                           00000051
POS_RAM                           00000047
POS_RAM_AUX                       00000048
POS_REALTIME                      00000030
POS_SERVO                         0000040A
PR2                               00000FCB
PREINC0                           00000FEC
PREINC1                           00000FE4
PREINC2                           00000FDC
PROD                              00000FF3
PRODH                             00000FF4
PRODL                             00000FF3
PRSEN                             00000007
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 28


SYMBOL TABLE
  LABEL                             VALUE 

PSA                               00000003
PSP0                              00000000
PSP1                              00000001
PSP2                              00000002
PSP3                              00000003
PSP4                              00000004
PSP5                              00000005
PSP6                              00000006
PSP7                              00000007
PSPIE                             00000007
PSPIF                             00000007
PSPIP                             00000007
PSPMODE                           00000004
PSSAC0                            00000002
PSSAC1                            00000003
PSSBD0                            00000000
PSSBD1                            00000001
PULSE_10uS                        00000190
PWM1CON                           00000FB7
PWM_FIRST_TIME                    00000015
R                                 00000002
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RA5                               00000005
RA6                               00000006
RA7                               00000007
RB0                               00000000
RB1                               00000001
RB2                               00000002
RB3                               00000003
RB4                               00000004
RB5                               00000005
RB6                               00000006
RB7                               00000007
RBIE                              00000003
RBIF                              00000000
RBIP                              00000000
RBPU                              00000007
RC0                               00000000
RC1                               00000001
RC2                               00000002
RC3                               00000003
RC4                               00000004
RC5                               00000005
RC6                               00000006
RC7                               00000007
RCEN                              00000003
RCIDL                             00000006
RCIE                              00000005
RCIF                              00000005
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 29


SYMBOL TABLE
  LABEL                             VALUE 

RCIP                              00000005
RCMT                              00000006
RCON                              00000FD0
RCREG                             00000FAE
RCSTA                             00000FAB
RD                                00000000
RD0                               00000000
RD1                               00000001
RD16                              00000007
RD2                               00000002
RD3                               00000003
RD4                               00000004
RD5                               00000005
RD6                               00000006
RD7                               00000007
RE0                               00000000
RE1                               00000001
RE2                               00000002
RE3                               00000003
REBOTS                            00000017
RI                                00000004
RSEN                              00000001
RSI_T0                            0000013E
RX                                00000007
RX9                               00000006
RX9D                              00000000
RXDTP                             00000005
R_NOT_W                           00000002
R_W                               00000002
S                                 00000003
SALTO_LINEA                       00000039
SALTO_Y_ENTER                     000001F8
SAVE_MAX                          00000504
SBOREN                            00000006
SCK                               00000003
SCKP                              00000004
SCL                               00000003
SCS0                              00000000
SCS1                              00000001
SDA                               00000004
SDI                               00000004
SDO                               00000005
SECONDS_ECHO                      00000019
SEN                               00000000
SENDB                             00000003
SERVO_POS                         00000016
SI_GUION                          000002E8
SMP                               00000007
SP0                               00000000
SP1                               00000001
SP2                               00000002
SP3                               00000003
SP4                               00000004
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 30


SYMBOL TABLE
  LABEL                             VALUE 

SPBRG                             00000FAF
SPBRGH                            00000FB0
SPEN                              00000007
SREN                              00000005
SSPADD                            00000FC8
SSPBUF                            00000FC9
SSPCON1                           00000FC6
SSPCON2                           00000FC5
SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
SSPIP                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPOV                             00000006
SSPSTAT                           00000FC7
STATUS                            00000FD8
STKFUL                            00000007
STKOVF                            00000007
STKPTR                            00000FFC
STKUNF                            00000006
SWDTE                             00000000
SWDTEN                            00000000
SYNC                              00000004
T016BIT                           00000006
T08BIT                            00000006
T0CKI                             00000004
T0CON                             00000FD5
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0PS0                             00000000
T0PS1                             00000001
T0PS2                             00000002
T0SE                              00000004
T13CKI                            00000000
T1CKI                             00000000
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000FCD
T1OSCEN                           00000003
T1OSI                             00000001
T1OSO                             00000000
T1RUN                             00000006
T1SYNC                            00000002
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000FCA
T2OUTPS0                          00000003
T2OUTPS1                          00000004
T2OUTPS2                          00000005
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 31


SYMBOL TABLE
  LABEL                             VALUE 

T2OUTPS3                          00000006
T3CCP1                            00000003
T3CCP2                            00000006
T3CKPS0                           00000004
T3CKPS1                           00000005
T3CON                             00000FB1
T3SYNC                            00000002
TABLAT                            00000FF5
TAULA7S                           00000020
TBLPTR                            00000FF6
TBLPTRH                           00000FF7
TBLPTRL                           00000FF6
TBLPTRU                           00000FF8
TMR0                              00000FD6
TMR0H                             00000FD7
TMR0IE                            00000005
TMR0IF                            00000002
TMR0IP                            00000002
TMR0L                             00000FD6
TMR0ON                            00000007
TMR1                              00000FCE
TMR1CS                            00000001
TMR1H                             00000FCF
TMR1IE                            00000000
TMR1IF                            00000000
TMR1IP                            00000000
TMR1L                             00000FCE
TMR1ON                            00000000
TMR2                              00000FCC
TMR2IE                            00000001
TMR2IF                            00000001
TMR2IP                            00000001
TMR2ON                            00000002
TMR3                              00000FB2
TMR3CS                            00000001
TMR3H                             00000FB3
TMR3IE                            00000001
TMR3IF                            00000001
TMR3IP                            00000001
TMR3L                             00000FB2
TMR3ON                            00000000
TO                                00000003
TOS                               00000FFD
TOSH                              00000FFE
TOSL                              00000FFD
TOSU                              00000FFF
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRISA                             00000F92
TRISA0                            00000000
TRISA1                            00000001
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 32


SYMBOL TABLE
  LABEL                             VALUE 

TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISA5                            00000005
TRISA6                            00000006
TRISA7                            00000007
TRISB                             00000F93
TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
TRISC                             00000F94
TRISC0                            00000000
TRISC1                            00000001
TRISC2                            00000002
TRISC3                            00000003
TRISC4                            00000004
TRISC5                            00000005
TRISC6                            00000006
TRISC7                            00000007
TRISD                             00000F95
TRISD0                            00000000
TRISD1                            00000001
TRISD2                            00000002
TRISD3                            00000003
TRISD4                            00000004
TRISD5                            00000005
TRISD6                            00000006
TRISD7                            00000007
TRISE                             00000F96
TRISE0                            00000000
TRISE1                            00000001
TRISE2                            00000002
TRMT                              00000001
TUN0                              00000000
TUN1                              00000001
TUN2                              00000002
TUN3                              00000003
TUN4                              00000004
TX                                00000006
TX9                               00000006
TX9D                              00000000
TXCKP                             00000004
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXIP                              00000004
TXREG                             00000FAD
TXSTA                             00000FAC
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 33


SYMBOL TABLE
  LABEL                             VALUE 

UA                                00000001
UNITATS                           00000044
VCFG0                             00000004
VCFG1                             00000005
VDIRMAG                           00000007
VPP                               00000003
VREFM                             00000002
VREFP                             00000003
W                                 00000000
WAIT_ADC                          000003B6
WAIT_ADC2                         000003DE
WAIT_RX                           0000058C
WAIT_TX                           00000596
WCOL                              00000007
WDTCON                            00000FD1
WR                                00000001
WREG                              00000FE8
WREN                              00000002
WRERR                             00000003
WUE                               00000001
Z                                 00000002
ZERO                              0000043A
_BBSIZ_BB1K_4L                    000000FF
_BBSIZ_BB256_4L                   000000CF
_BBSIZ_BB512_4L                   000000DF
_BORV_0_2L                        000000E7
_BORV_1_2L                        000000EF
_BORV_2_2L                        000000F7
_BORV_3_2L                        000000FF
_BOR_NOSLP_2L                     000000FD
_BOR_OFF_2L                       000000F9
_BOR_ON_2L                        000000FF
_BOR_SOFT_2L                      000000FB
_CCP2MX_RB3_3H                    000000FE
_CCP2MX_RC1_3H                    000000FF
_CONFIG1H                         00300001
_CONFIG2H                         00300003
_CONFIG2L                         00300002
_CONFIG3H                         00300005
_CONFIG4L                         00300006
_CONFIG5H                         00300009
_CONFIG5L                         00300008
_CONFIG6H                         0030000B
_CONFIG6L                         0030000A
_CONFIG7H                         0030000D
_CONFIG7L                         0030000C
_CP0_OFF_5L                       000000FF
_CP0_ON_5L                        000000FE
_CP1_OFF_5L                       000000FF
_CP1_ON_5L                        000000FD
_CPB_OFF_5H                       000000FF
_CPB_ON_5H                        000000BF
_CPD_OFF_5H                       000000FF
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 34


SYMBOL TABLE
  LABEL                             VALUE 

_CPD_ON_5H                        0000007F
_DEBUG_OFF_4L                     000000FF
_DEBUG_ON_4L                      0000007F
_DEVID1                           003FFFFE
_DEVID2                           003FFFFF
_EBTR0_OFF_7L                     000000FF
_EBTR0_ON_7L                      000000FE
_EBTR1_OFF_7L                     000000FF
_EBTR1_ON_7L                      000000FD
_EBTRB_OFF_7H                     000000FF
_EBTRB_ON_7H                      000000BF
_FCMEN_OFF_1H                     000000BF
_FCMEN_ON_1H                      000000FF
_IDLOC0                           00200000
_IDLOC1                           00200001
_IDLOC2                           00200002
_IDLOC3                           00200003
_IDLOC4                           00200004
_IDLOC5                           00200005
_IDLOC6                           00200006
_IDLOC7                           00200007
_IESO_OFF_1H                      0000007F
_IESO_ON_1H                       000000FF
_LPT1OSC_OFF_3H                   000000FB
_LPT1OSC_ON_3H                    000000FF
_LVP_OFF_4L                       000000FB
_LVP_ON_4L                        000000FF
_MCLRE_OFF_3H                     0000007F
_MCLRE_ON_3H                      000000FF
_OSC_ECIO_1H                      000000F5
_OSC_EC_1H                        000000F4
_OSC_HSPLL_1H                     000000F6
_OSC_HS_1H                        000000F2
_OSC_INTIO1_1H                    000000F9
_OSC_INTIO2_1H                    000000F8
_OSC_LP_1H                        000000F0
_OSC_RCIO_1H                      000000F7
_OSC_RC_1H                        000000F3
_OSC_XT_1H                        000000F1
_PBADEN_ANA_3H                    000000FF
_PBADEN_DIG_3H                    000000FD
_PWRT_OFF_2L                      000000FF
_PWRT_ON_2L                       000000FE
_STVREN_OFF_4L                    000000FE
_STVREN_ON_4L                     000000FF
_WDTPS_1024_2H                    000000F5
_WDTPS_128_2H                     000000EF
_WDTPS_16384_2H                   000000FD
_WDTPS_16_2H                      000000E9
_WDTPS_1_2H                       000000E1
_WDTPS_2048_2H                    000000F7
_WDTPS_256_2H                     000000F1
_WDTPS_2_2H                       000000E3
MPASM 5.84             NEWPIC_8B_GENERAL.ASM   4-27-2021  12:35:24         PAGE 35


SYMBOL TABLE
  LABEL                             VALUE 

_WDTPS_32768_2H                   000000FF
_WDTPS_32_2H                      000000EB
_WDTPS_4096_2H                    000000F9
_WDTPS_4_2H                       000000E5
_WDTPS_512_2H                     000000F3
_WDTPS_64_2H                      000000ED
_WDTPS_8192_2H                    000000FB
_WDTPS_8_2H                       000000E7
_WDT_OFF_2H                       000000FE
_WDT_ON_2H                        000000FF
_WRT0_OFF_6L                      000000FF
_WRT0_ON_6L                       000000FE
_WRT1_OFF_6L                      000000FF
_WRT1_ON_6L                       000000FD
_WRTB_OFF_6H                      000000FF
_WRTB_ON_6H                       000000BF
_WRTC_OFF_6H                      000000FF
_WRTC_ON_6H                       000000DF
_WRTD_OFF_6H                      000000FF
_WRTD_ON_6H                       0000007F
_XINST_OFF_4L                     000000BF
_XINST_ON_4L                      000000FF
__18F4321                         00000001
nLETRAS                           00000034
nLETRAS_AUX                       00000035
nTIMES                            00000014
nTIMES_MAX                        00000052

Errors   :     0
Warnings :     2 reported,     0 suppressed
Messages :     0 reported,     0 suppressed

